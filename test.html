<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Arena Sport 1 - Widevine DRM</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/shaka-player/4.3.5/shaka-player.compiled.js"></script>
    <style>
      body {
        margin: 0;
        background-color: black;
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100vh;
      }
      video {
        width: 100%;
        max-width: 1000px;
        aspect-ratio: 16 / 9;
        background-color: #000;
      }
    </style>
  </head>
  <body>
    <video id="video" autoplay controls></video>

    <script>
      async function initPlayer() {
        // Install polyfills
        shaka.polyfill.installAll();

        // Check if the browser supports Shaka
        if (!shaka.Player.isBrowserSupported()) {
          alert('Browser not supported!');
          return;
        }

        // Create player instance
        const video = document.getElementById('video');
        const player = new shaka.Player(video);

        // Optional: Listen to error events
        player.addEventListener('error', (event) => {
          console.error('Error code', event.detail.code, 'object', event.detail);
        });

        // Configure Widevine DRM license server
        player.configure({
          drm: {
            servers: {
              'com.widevine.alpha': 'https://drm.antik.sk/widevine/key'
            }
          }
        });

        // Load your MPD stream
        const manifestUri = 'https://dash2.antik.sk/stream/nvidia_arena_sport1/playlist_cenc.mpd';

        try {
          await player.load(manifestUri);
          console.log('The video has now been loaded!');
        } catch (error) {
          console.error('Error loading video:', error);
        }
      }

      // Start player
      document.addEventListener('DOMContentLoaded', initPlayer);
    </script>
  </body>
</html>
